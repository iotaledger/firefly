<script lang="typescript">
    import { localize } from '@core/i18n'
    import { newTransactionDetails, updateNewTransactionDetails } from '@core/wallet'
    import { Button } from 'shared/components'
    import { onMount } from 'svelte'
    import { RecipientInput } from '../../../../../components'
    import { sendRouter } from '../../../../../lib/routers'
    import { IAddressSubject } from '@core/wallet'

    let recipient: IAddressSubject
    let recipientValidationError: string
    let recipientInputElement: HTMLInputElement

    onMount(() => {
        recipientInputElement?.focus()
        // eslint-disable-next-line @typescript-eslint/ban-ts-comment
        // @ts-ignore
        recipient = $newTransactionDetails?.recipient
    })

    function onContinueClick(): void {
        updateNewTransactionDetails({ type: $newTransactionDetails.type, recipient })
        $sendRouter.next()
    }
</script>

<div class="w-full overflow-y-auto flex flex-col flex-auto h-1 justify-between">
    <RecipientInput bind:recipient bind:error={recipientValidationError} bind:inputElement={recipientInputElement} />
    <Button disabled={!!recipientValidationError} outline classes="w-full" onClick={onContinueClick}>
        {recipientValidationError ?? localize('actions.continue')}
    </Button>
</div>
